<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 2.0.45"/><title data-react-helmet="true">eeearl - Android에서 SQLite를 close 하지마라!?</title><link data-react-helmet="true" rel="canonical" href="https://eeearl.com//2014-01-03-android-dont-close-sqlite"/><meta data-react-helmet="true" name="description" content="small talk for life live love and programing"/><meta data-react-helmet="true" property="og:url" content="https://eeearl.com//2014-01-03-android-dont-close-sqlite"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="Android에서 SQLite를 close 하지마라!?"/><meta data-react-helmet="true" property="og:description" content="small talk for life live love and programing"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:creator" content="@eeeearl"/><meta data-react-helmet="true" name="twitter:title" content="Android에서 SQLite를 close 하지마라!?"/><meta data-react-helmet="true" name="twitter:description" content="small talk for life live love and programing"/><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-63993792-1', 'auto', {});
      
      }
      </script><link rel="alternate" type="application/rss+xml" title="Gatsby RSS Feed" href="/rss.xml"/><link as="script" rel="preload" href="/1-d7db85b7570d2d479719.js"/><link as="script" rel="preload" href="/component---src-templates-blog-template-js-c285264a984fc51fe952.js"/><link as="script" rel="preload" href="/0-5f0d6467faf885092036.js"/><link as="script" rel="preload" href="/app-b8d549ec558f6b6d1536.js"/><link as="script" rel="preload" href="/webpack-runtime-8957f5b11be1234138ce.js"/><link rel="preload" href="/static/d/889/path---2014-01-03-android-dont-close-sqlite-305-83e-nqP0V0JNMkp34g1xcPquAtiw0rY.json" as="fetch" crossOrigin="use-credentials"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><style data-emotion-css="6gxhc5">.css-6gxhc5{height:120px;}</style><header class="wrapper css-6gxhc5 e3rsph00"><style data-emotion-css="tvsf5l">.css-tvsf5l{display:inline-block;color:#838383;font-size:28px;margin-top:8px;}</style><a class="css-tvsf5l" href="/">eeearl</a><style data-emotion-css="187t4uh">.css-187t4uh{color:#E0E0E0;float:right;margin:18px 0;}</style><div class="css-187t4uh e3rsph01"><style data-emotion-css="qqxhel">.css-qqxhel{color:#E0E0E0;margin:0 8px;}</style><a class="css-qqxhel" href="/about">about</a><a class="css-qqxhel" href="/blog">blog</a></div></header><div class="post-content"><div class="wrapper"><span>2014 Jan 03</span><style data-emotion-css="1xikluh">.css-1xikluh{padding:0 0 30px 0 !important;line-height:normal;border-bottom:none !important;}</style><h1 class="css-1xikluh e1q6z0350">Android에서 SQLite를 close 하지마라!?</h1><div class="blog-post-content"><p>안드로이드에서 내부에 데이터를 저장해야 할 경우 Sqlite를 편리하게 사용됩니다. 파일 형식이기 때문에 데이터를 입력하기 전엔 open을 하고 다 입력을 하면 close를 해서 사용하는 것이 일반적입니다.</p>
<p>특정 액션에서만 데이터를 입력할 경우 open과 close 를 순차적으로 호출하면 되지만 네트워크를 여러번 비동기로 호출해서 데이터를 저장할 경우 open과 close 가 무작위로 실행되다 close된 상태에서 데이터를 입력하면 에러가 발생해 어디서 호출 해야하나 고민을 잠깐 했었습니다.</p>
<p>제가생각했던 간단한 방법은 Activity의 Lifecycle을 생각해서 Resume과 Pause에 open과 close를 해도 되지만 구글링을 하던중에 Android Framework Engineer 가 안드로이드에서는 close를 하지 않아도 된다는 내용을 보았습니다. (close를 권장하지 않았던 걸로 기억합니다) 안드로이드 내에서 자동으로 close 된다고 했습니다.</p>
<p>실제로 테스트 해보니 에러가 나오지 않았습니다.</p>
<p>그러면 제 문제를 봤을때 비동기적인 상황에서 계속 해서 open호출 하면 안돼고 Singleton Pattern을 사용해서 공통된 인스턴스만 사용하게 하자 라고 생각해 코드를 작성했습니다.</p>
<pre><code>public class SQLiteHelper extends SQLiteOpenHelper {

    private static final String DB_NAME = "DB_NAME";
    private static final int DB_VERSION = 1;

    private static SQLiteHelper INSTANCE;
    private static SQLiteDatabase mDb;

    public static SQLiteHelper getInstance(Context context) {
        if (INSTANCE == null) {
            INSTANCE = new SQLiteHelper(context.getApplicationContext());
            mDb = INSTANCE.getWritableDatabase();
        }

        return  INSTANCE;
    }

    public void open() {
        if (mDb.isOpen() == false) {
            INSTANCE.onOpen(mDb);
        }
    }

    public SQLiteHelper(Context context) {
        super(context, DB_NAME, null, DB_VERSION);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    }
}
</code></pre></div></div></div><style data-emotion-css="6gxhc5">.css-6gxhc5{height:120px;}</style><footer class="wrapper css-6gxhc5 et2kv7a0"><style data-emotion-css="yx7h9z">.css-yx7h9z{display:block;color:#838383;font-size:1em;margin-top:8px;text-align:right;}</style><div class="css-yx7h9z et2kv7a1">eeearl.com</div></footer></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-blog-template-js","jsonName":"2014-01-03-android-dont-close-sqlite-305","path":"/2014-01-03-android-dont-close-sqlite"};window.dataPath="889/path---2014-01-03-android-dont-close-sqlite-305-83e-nqP0V0JNMkp34g1xcPquAtiw0rY";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-b8d549ec558f6b6d1536.js"],"component---src-templates-blog-template-js":["/component---src-templates-blog-template-js-c285264a984fc51fe952.js"],"component---src-pages-about-js":["/component---src-pages-about-js-cb4b3b32299d45eb96b0.js"],"component---src-pages-blog-js":["/component---src-pages-blog-js-dd72aa9d5e8b9db6ee35.js"],"component---src-pages-index-js":["/component---src-pages-index-js-890abc9b28a5c433d1b9.js"]};/*]]>*/</script><script src="/webpack-runtime-8957f5b11be1234138ce.js" async=""></script><script src="/app-b8d549ec558f6b6d1536.js" async=""></script><script src="/0-5f0d6467faf885092036.js" async=""></script><script src="/component---src-templates-blog-template-js-c285264a984fc51fe952.js" async=""></script><script src="/1-d7db85b7570d2d479719.js" async=""></script></body></html>